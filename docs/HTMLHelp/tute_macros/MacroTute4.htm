<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<!--(==============================================================)-->
<!--(Document created with RoboEditor. )============================-->
<!--(==============================================================)-->

<head>

<title>Creating the Main Macro</title>

<!--(Meta)==========================================================-->

<meta http-equiv=content-type content="text/html; charset=windows-1252">
<meta name=generator content="RoboHELP by eHelp Corporation - www.ehelp.com">
<meta name=generator-major-version content=0.1>
<meta name=generator-minor-version content=1>
<meta name=filetype content=kadov>
<meta name=filetype-version content=1>
<meta name=page-count content=1>
<meta name=layout-height content=2025>
<meta name=layout-width content=1311>


<!--(Links)=========================================================-->

<link rel="StyleSheet" href="..\Hexedit.css">



</head>

<!--(Body)==========================================================-->


<body>

<h2><font style="font-family: Arial;"
			face=Arial>Step 4. Creating the Main Macro</font></h2>

<p style="margin-top: 0;
			margin-bottom: 0;
			text-align: center;"
	align=center>&nbsp;</p>

<p style="margin-top: 0;
			margin-bottom: 0;
			text-align: center;"
	align=center><a href="MacroTute3.htm"><img src="../preva.gif"
												x-maintain-ratio=TRUE
												style="border-style: none;
														border: none;
														width: 52px;
														height: 24px;
														float: none;"
												width=52
												height=24
												border=0></a> <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a 
 href="MacroTute5.htm"><!--kadov_tag{{</spaces>}}--><img src="../nexta.gif"
														x-maintain-ratio=TRUE
														style="border-style: none;
	border: none;
	width: 52px;
	height: 24px;
	float: none;"
														width=52
														height=24
														border=0></a></p>

<p style="margin-top: 0;
			margin-bottom: 0;
			font-weight: bold;">Setup</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;">Once again we need to create 
 a work file. <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->This 
 will be a file that will act as our file to be encrypted while we create 
 the macro.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=Body-Text-Indent-2>1. Close files you already have open (if any) 
 then use File/New to open the New File dialog.</p>

<p class=Body-Text-Indent-2>2. In the New File dialog select the &quot;Fill 
 with: Hex&quot; option and enter &quot;00&quot; for the hex value.</p>

<p class=Body-Text-Indent-2>3. Select the &quot;Size: Specified&quot; option 
 and enter &quot;1000&quot; for the size.</p>

<p class=Body-Text-Indent-2>4. Make sure the &quot;Prompt for disk file 
 name&quot; check box is off and click OK.</p>

<p class=Body-Text-Indent-2>5. Make sure the file is not read-only (ie, 
 in RW mode) and is also in OVR mode.</p>

<p class=Body-Text-Indent-2>6. Use the Tools/Calculator menu item to display 
 the calculator.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;">Now we will record the macro. 
 <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->The first 
 thing this macro will do is display a message to the user telling him/her 
 what it does and how it should be used. <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->This 
 should tell the user that no other files should be open.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=Body-Text-Indent-2>7. Use Tools/Record to start macro recording, 
 and check that the &quot;REC&quot; status is on.</p>

<p class=Body-Text-Indent-2>8. Select Tools/Macro Message command to open 
 the Message dialog.</p>

<p class=Body-Text-Indent-2>9. Enter a message describing what the macro 
 does and any requirements.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;">In particular, you need to 
 mention that the file to be encrypted must be the only file open and that 
 it must be writeable and in OVR mode. <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->Also 
 remind the user that the original contents of the file will be overwritten 
 and that they will need to save the contents of the generated random file 
 in order to decrypt the file again</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;"><img src="../tip.gif"
												style="border-style: none;
														border: none;
														width: 31px;
														height: 12px;"
												width=31
												height=12
												border=0>Pressing the Enter 
 key will close the dialog. <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->To 
 add a new-line to the message press Ctrl+Enter.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p style="margin-top: 0;
			margin-bottom: 0;
			text-align: center;"
	align=center><img src="MacroTuteShot4-1.gif" style="border-style: none;
								border: none;
								width: 254px;
								height: 186px;" width="254" height="186" border="0"></p>

<p style="margin-top: 0;
			margin-bottom: 0;
			text-align: center;"
	align=center>&nbsp;</p>

<p style="margin-top: 0;
			margin-bottom: 0;
			font-weight: bold;
			text-align: center;"
	align=center><span style="font-weight: bold;">Figure 4.1 The Macro 
 Message dialog.</span></p>

<p>&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;">Next we get the file length 
 of the open file and create a new file of the same length filled with 
 random bytes.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=Body-Text-Indent-2>10. In the calculator click the &quot;C&quot; 
 (clear) button and set &quot;Bits:&quot; to 64 bit mode.</p>

<p class=Body-Text-Indent-2>11. Then click the EOF button to load the length 
 of the file (1000 or 3E8h) into it.</p>

<p class=Body-Text-Indent-2>12. Then click the &quot;=&quot; button (below 
 the &quot;3&quot; button) in the calculator.</p>

<p class=Body-Text-Indent-2>&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;"><img src="../tip.gif"
												style="border-style: none;
														border: none;
														width: 31px;
														height: 12px;"
												width=31
												height=12
												border=0>Calculator operations 
 are only stored in keystroke macros when an operation is performed, <span 
 style="font-weight: bold;">not</span> when a value is simply entered or 
 loaded. <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->Unless 
 you click the &quot;=&quot; button the macro will not remember to load 
 the file length into the calculator.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=Body-Text-Indent-2>13. Use File/New to open the New File dialog.</p>

<p class=Body-Text-Indent-2>14. Select &quot;Size: Take size from Calculator&quot; 
 and &quot;Fill with: Random&quot;. <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->Leave 
 &quot;0-255&quot; in the random byte range.</p>

<p class=Body-Text-Indent-2>&nbsp;</p>

<p class=Body-Text-Indent-2
	style="margin-left: 0px; text-align: center;"
	align=center><img src="MacroTuteShot4-2.gif" style="border-style: none;
								border: none;
								width: 462px;
								height: 381px;" width="462" height="381" border="0"></p>

<p style="text-align: center;"
	align=center>&nbsp;</p>

<p style="text-align: center; font-weight: bold;"
	align=center>Figure 4.2 Creating the random file.</p>

<p>&nbsp;</p>

<p class=Body-Text-Indent-2>15. Click OK to create the random file.</p>

<p class=Body-Text-Indent-2>16. Use Window/Next Window to move back to 
 the original file.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;">Now we just call the nested 
 macro.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=Body-Text-Indent-2>17. Open the Replay Macro dialog by pressing 
 F9 (or using the Tools/Play command).</p>

<p class=Body-Text-Indent-2>18. Select the nested macro (_XOR_nested_macro) 
 from the list and click OK.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;"><img src="../ex_red_sm.jpg"
												style="border-style: none;
														border: none;
														width: 17px;
														height: 20px;"
												width=17
												height=20
												border=0> The macro may 
 take a while to run and then displays the message &quot;error encountered 
 in macro execution&quot; which just indicates that it stopped trying to 
 run when it reached the end of file.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;">In order to decrypt the file 
 again the user needs to keep a copy of the random file.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=Body-Text-Indent-2>19. Use Window/Next Window to move to the random 
 file.</p>

<p class=Body-Text-Indent-2>20. Use Tools/Macro Message to display this 
 message: &quot;Please save your random file.&quot;.</p>

<p class=Body-Text-Indent-2>21. Use File/Save As... to allow the user to 
 save the file. <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->Enter 
 a file name and click Save.</p>

<p class=Body-Text-Indent-2>&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;">Use any temporary file name 
 when saving during recording. This name will not be recorded in the macro; 
 instead the user will have to enter a name when the macro runs.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=Body-Text-Indent-2>22. A message is displayed about losing undo 
 information when saving in a macro. <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->Click 
 OK.</p>

<p class=Body-Text-Indent-2>&nbsp;</p>

<p class=Body-Text-Indent-2
	style="margin-left: 0px; text-align: center;"
	align=center><img src="MacroTuteShot4-3.gif" style="border-style: none;
								border: none;
								width: 239px;
								height: 146px;" width="239" height="146" border="0"></p>

<p style="text-align: center;"
	align=center>&nbsp;</p>

<p style="text-align: center; font-weight: bold;"
	align=center>Figure 4.3 Click OK to save the file.</p>

<p>&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;">Finally we ask the user if 
 they want to overwrite the original file with the encrypted version.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p class=Body-Text-Indent-2>23. Use Window/Next Window to move to the original 
 (now encrypted) file.</p>

<p class=Body-Text-Indent-2>24. Use Tools/Macro Message to display this 
 message: &quot;Do you want to save this encrypted file? Click Cancel if 
 not!&quot;.</p>

<p class=Body-Text-Indent-2>25. Use File/Save to save the file. <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->Click 
 OK to continue when warned about undo information.</p>

<p class=Body-Text-Indent-2>26. Press F7 to turn off recording.</p>

<p class=Body-Text-Indent-2>27. Close the two files since we have finished 
 with them. <!--kadov_tag{{<spaces>}}-->&nbsp;<!--kadov_tag{{</spaces>}}-->You 
 might also like to delete the copies saved to disk.</p>

<p style="margin-top: 0; margin-bottom: 0;">&nbsp;</p>

<p style="margin-top: 0; margin-bottom: 0;">In the next step we will finish 
 up.</p>

<p style="margin-top: 0;
			margin-bottom: 0;
			text-align: center;"
	align=center><a href="MacroTute3.htm"><img src="../preva.gif"
												x-maintain-ratio=TRUE
												style="border-style: none;
														border: none;
														width: 52px;
														height: 24px;
														float: none;"
												width=52
												height=24
												border=0></a> <!--kadov_tag{{<spaces>}}-->&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a 
 href="MacroTute5.htm"><!--kadov_tag{{</spaces>}}--><img src="../nexta.gif"
														x-maintain-ratio=TRUE
														style="border-style: none;
	border: none;
	width: 52px;
	height: 24px;
	float: none;"
														width=52
														height=24
														border=0></a></p>

<p>&nbsp;</p>

</body>

</html>
